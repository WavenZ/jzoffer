## 面试题 65：不用加减乘除做加法

> 题目：写一个函数，求两个整数之和，要求在函数体内不得使用 “+”、“-”、“×”、“÷” 四则运算符号。

首先我们可以分析人们是如何做十进制加法的，比如是如何得出 5 + 17 = 22 这个结果的。实际上，我们可以分成三步进行：第一步只要做各位相加不进位，此时相加的结果为 12（个位数 5 和 7 相加不要进位是 2，十位数 0 和 1 相加结果是 1）；第二步做进位，5 + 7 有进位，进位的值是 10；第三步把前面两个结果加起来，12 + 10 的结果是 22，刚好 5 + 17 = 22。

接下来分析二进制，5 的二进制是 101，17 的二进制是 10001。第一步：各位相加不计进位，得到的结果是 10100（最后一位两个数都是 1，相加的结果是二进制的 10。这一步不计进位，因此结果仍然是 0）；第二步记下进位，在这个例子中只在最后一位相加时产生一个进位，结果是二进制的 10；第三步把前两步的结果相加，得到的结果是 10110，转换成十进制正好是 22。

接下来试着把二进制的加法用位运算来替代。第一步不考虑进位对每一位相加。0加0、1加1的结果都是0,0加1、1加0的结果都是1。我们注意到，这和异或的结果是一样的。对异或而言，0和0、1和1的异或结果是0，而0和1、1和0的异或结果是1.接着考虑第二步进位，对0加0、0加1、1加0而言，都不会产生进位，只有1加1时，会向前产生一个进位。此时我们想象成两个数先做位与运算，然后在向左移动一位。只有两个数都是1的时候，位与得到的结果是1，其余都是0.第三步把前两个步骤的结果相加。第三步相加的过程仍然是重复前两步，直到不产生进位为止。

```cpp
int Add(int num1, int num2)
{
    int sum, carry;
    do{
        sum = num1 ^ num2;
        carry = (num1 & num2) << 1;
        num1 = sum;
        num2 = carry;
    }while(num2 != 0);

    return num1;
}
```